# Сервис опросов

[Запуск приложения](#Start)

[Работа в панели администратора](#Admin)

+ [Авторизация в панели админа](#Login)
+ [Выход из панели админа](#Logout)
+ [Создание опроса](#CreatePoll)
+ [Обновление опроса](#UpdatePoll)
+ [Удаление опроса](#DeletePoll)


## <a name="Start"></a> Запуск приложения

1) Переходим в директорию /dev, где лежит файл *docker-compose.yaml* . В терминале выполняем команду **docker-compose up -d** (запуск СУБД).
3) Переходим в корневой каталог, где лежит файл *pom.xml*. В терминале выполняем команду **mvn clean install**. Ждем пока билд завершится.
Liquibase накатывает нужные таблицы и заполняет их тестовыми данными.
5) Переходим в директорию /target, где лежит файл *qa-service-0.0.1-SNAPSHOT.jar*. В терминале выполняем команду java -jar qa-service-0.0.1-SNAPSHOT.jar. Приложение запустилось на локальной машине на порту 8080.

## <a name="Admin"></a> Работа в панели администратора

#### <a name="Login"></a> 1) Реализована авторизация по логину и паролю с валидацией и проверкой в БД.

*POST http://localhost:8080/admin/login*:

`{"login": "admin", "password": "aaddmmiin"}`

В случае удачной авторизации сессия администратора сохраняется до выхода (логаута). Админ имеет доступ к действиям пользователя без прав,
при этом обычный юзер не имеет возможности работать в панели администратора.

#### <a name="Logout"></a> 2) Успешный логаут возможен, только если пользователь до этого был авторизован как админ

*POST http://localhost:8080/admin/logout*

#### <a name="CreatePoll"></a> 3) Создание опроса

В теле запроса передаем название, описание и дату завершения опроса. Все поля должны быть заполнены (**null / ""** значения не являются валидными).
Дата окончания опроса может быть раньше текущей календарной даты. Такой опрос будем считать неактивным.

*POST http://localhost:8080/admin/polls*

`{"name": "Хороший опрос", "description": "Сделаем нормальный опрос", "endDate": "01/01/2027"}`

Успешный ответ - информация о созданном запросе:

`{
    "pollId": 3,
    "name": "Хороший опрос",
    "endDate": "01.01.27 0:00",
    "description": "Сделаем нормальный опрос"
}`

#### <a name="UpdatePoll"></a> 4) Обновление опроса

Тело запроса аналогично запросу при создании опроса, только отсутсвует валидация полей. Дата валидируется только форматом dd/MM/yyyy.

*PATCH http://localhost:8080/admin/polls/{poolId}*

Пример: *PATCH http://localhost:8080/admin/polls/3*

`{"name": "", "description": "Хах", "endDate": "13/13/2019"}`

Успешный ответ: 

`{
    "pollId": 3,
    "name": "",
    "endDate": "13.01.20 0:00",
    "description": "Хах"
}`


#### <a name="DeletePoll"></a> 5) Удаление опроса

Удаляем запрос по его ID. Если опроса с таким ID нет, администратор будет уведомлен об этом.

*DELETE http://localhost:8080/admin/polls/{poolId}*

Пример: *DELETE http://localhost:8080/admin/polls/3*

Успешный ответ: 

**Опрос с ID = 3 был удален**

Ошибка:

**Опрос с ID = 3 не существует!**


